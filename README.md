# XGBoost4IntelligencePrediction

This repository contains the main scipts used to predict an intellegice phenotype based on genotype data for 57,558 samples (post quality control). This study is descibed in the preprint, [Comparing the XGBoost machine learning algorithm to polygenic scoring for the prediction of intelligence based on genotype data](https://www.biorxiv.org/content/10.1101/2022.06.12.495467v1).

The workflow used is visualised below. First, sample independent feature selection was performed which involved filtering SNPs by their annotation. The data was then split into five folds, leaving one fold to report the final model performance. The remaining four folds were used for model optimisation and training. In 3-fold cross-validation, two folds were used for training and one as validation data to evaluate the model's performance. A GWAS was run on each fold, followed by LD clumping. The first parameter optimised was the P value threshold (Pt) for feature selection, followed by the XGBoost hyperparameters (HPs). Model optimisation involved choosing the model with the hyperparameter values that resulted in the highest AUC on the validation dataset. Sample dependent feature selection was then performed (involved running a GWAS, performing LD clumping and retaining SNPs that pass the best performing Pt) and the model was run using the best performing HPs on all four training folds. Predictions were made on the test fold. Finally, confounder adjustment was performed on the predictions and performance metrics were calculated.
